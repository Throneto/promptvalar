# 🚀 快速测试指南 - Studio 保存功能

## 📋 测试前准备

### 1. 确认服务状态
✅ 后端运行中：http://localhost:5000
✅ 前端运行中：http://localhost:3000

### 2. 准备测试账号
需要至少一个已注册的账号。如果没有，先注册一个。

---

## 🧪 5分钟快速测试流程

### 测试 1：创建并保存提示词（最重要！）⭐

**步骤：**

1. **打开浏览器访问：** http://localhost:3000

2. **登录**
   - 点击右上角 "Login"
   - 输入邮箱和密码
   - 点击 "Sign In"
   - ✅ 确认：右上角显示用户头像和名字

3. **进入 Studio**
   - 点击导航栏的 "Studio"
   - 或直接访问：http://localhost:3000/studio
   - ✅ 确认：看到 "Prompt Studio" 页面

4. **生成提示词**
   - 在输入框输入：`a beautiful sunset over the ocean`
   - 选择模型：Sora（默认）
   - 选择风格：Cinematic（默认）
   - 点击 "Generate Prompt" 按钮
   - ⏳ 等待 AI 生成（5-10秒）
   - ✅ 确认：看到生成的提示词

5. **保存提示词** 🔥
   - 滚动到页面底部
   - 看到一个**绿色的大按钮**："💾 保存提示词"
   - 点击这个按钮
   - ✅ 确认：弹出保存对话框

6. **填写表单**
   - **标题**（必填）：输入 `Beautiful Ocean Sunset`
   - **描述**：输入 `A cinematic sunset scene`
   - **分类**：选择 `视频生成`
   - **标签**：
     - 输入 `sunset` 按回车
     - 输入 `ocean` 按回车
     - 或点击推荐标签：`cinematic`
   - **预览图**：留空（可选）
   - ✅ 确认：所有字段填写完成

7. **提交保存**
   - 点击对话框底部的 "💾 保存" 按钮
   - ⏳ 等待保存
   - ✅ **关键验证点：**
     - 右上角出现绿色提示："提示词保存成功！"
     - 2秒后自动跳转到详情页
     - 详情页显示刚才保存的提示词

8. **验证保存成功**
   - 检查详情页的标题是否正确
   - 检查描述是否显示
   - 检查标签是否显示
   - ✅ 如果以上都正确，**保存功能测试通过！** 🎉

---

### 测试 2：编辑提示词 ✏️

**步骤：**

1. **进入"我的提示词"**
   - 点击右上角用户头像
   - 选择 "我的提示词"
   - 或直接访问：http://localhost:3000/dashboard/prompts
   - ✅ 确认：看到刚才创建的提示词

2. **点击编辑**
   - 找到刚才创建的提示词卡片
   - 悬停在卡片上
   - 点击 "编辑" 按钮（紫色）
   - ✅ 确认：跳转到 Studio，URL 包含 `?edit=xxx`

3. **验证数据加载**
   - ✅ 页面标题变为 "Edit Prompt"
   - ✅ 提示词内容已经显示
   - ✅ 保存按钮文字变为 "更新提示词"

4. **修改并更新**
   - 在结构化编辑器中做一些小修改
   - 点击 "更新提示词" 按钮
   - 在对话框中修改标题，添加 `- Updated`
   - 点击 "更新"
   - ✅ 确认：
     - 显示 "提示词更新成功！"
     - 跳转回详情页
     - 看到更新后的内容

---

### 测试 3：草稿自动保存 💾

**步骤：**

1. **开始新的提示词**
   - 访问：http://localhost:3000/studio（新页面）
   - 输入想法：`a futuristic city`
   - 生成提示词
   - ✅ 确认：提示词已生成

2. **测试草稿保存**
   - **不要点击保存！**
   - 直接刷新页面（F5）
   - ✅ **关键验证：**
     - 刷新后，之前的内容自动恢复了！
     - 想法还在
     - 生成的提示词还在

3. **测试草稿清除**
   - 现在保存这个提示词
   - 成功保存后，关闭标签页
   - 重新打开：http://localhost:3000/studio
   - ✅ 确认：页面是空的（草稿已清除）

---

## ✅ 核心功能检查清单

完成以上测试后，检查：

- [ ] ✅ 能成功创建新提示词
- [ ] ✅ 能成功保存到数据库
- [ ] ✅ 能从"我的提示词"看到
- [ ] ✅ 能编辑已有提示词
- [ ] ✅ 能更新提示词
- [ ] ✅ 草稿自动保存
- [ ] ✅ 草稿能恢复
- [ ] ✅ 保存后草稿清除
- [ ] ✅ 成功消息显示
- [ ] ✅ 自动跳转正常

---

## 🐛 如果遇到问题

### 问题 1：生成提示词失败
**可能原因：**
- OpenRouter API key 未配置
- 网络问题

**解决方法：**
```bash
# 检查后端环境变量
cd /root/promptvalar/backend
cat .env | grep OPENROUTER
```

### 问题 2：保存按钮不显示
**原因：** 没有生成提示词
**解决：** 先点击 "Generate Prompt"，等待生成完成

### 问题 3：401 未授权错误
**原因：** 未登录或 token 过期
**解决：** 重新登录

### 问题 4：草稿没有恢复
**检查：**
```javascript
// 在浏览器 Console 输入
localStorage.getItem('promptvalar_draft')
```

---

## 📊 测试报告模板

测试完成后，您可以这样报告：

```
✅ 测试 1：创建并保存 - 通过
✅ 测试 2：编辑提示词 - 通过
✅ 测试 3：草稿保存 - 通过

总结：所有核心功能正常工作！
```

或者：

```
❌ 测试 1：创建并保存 - 失败
   问题：保存时出现 500 错误
   错误信息：[具体错误]

需要修复...
```

---

## 🎯 预期结果

如果一切正常，您应该看到：

1. **创建流程顺畅**
   - 输入 → 生成 → 保存 → 跳转 ✅

2. **数据正确保存**
   - 在"我的提示词"中能看到 ✅
   - 详情页显示正确 ✅

3. **编辑功能正常**
   - 能加载数据 ✅
   - 能成功更新 ✅

4. **草稿功能可靠**
   - 自动保存 ✅
   - 自动恢复 ✅
   - 自动清除 ✅

---

## 🚀 开始测试吧！

打开浏览器，访问 http://localhost:3000，开始测试！

**预计测试时间：5-10 分钟**

祝测试顺利！🎉

