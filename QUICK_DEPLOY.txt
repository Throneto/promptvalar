========================================================================
               🚀 生产服务器快速部署指令
========================================================================

复制以下命令到生产服务器执行：

------------------------------------------------------------------------
步骤 1: 更新代码并修复构建问题
------------------------------------------------------------------------

cd /var/www/promptvalar
git pull origin main
./fix-production-deploy.sh


------------------------------------------------------------------------
步骤 2: 更新 Nginx 配置
------------------------------------------------------------------------

cd /var/www/promptvalar
sudo ./update-nginx-config.sh


------------------------------------------------------------------------
步骤 3: 配置 SSL 证书（需要 DNS 已配置）
------------------------------------------------------------------------

sudo certbot --nginx -d promptvalar.com -d www.promptvalar.com -d api.promptvalar.com


------------------------------------------------------------------------
步骤 4: 验证部署
------------------------------------------------------------------------

# 检查服务状态
pm2 status

# 测试 API
curl -I http://localhost:5000/health

# 测试前端
curl -I https://promptvalar.com

# 测试 API（外部）
curl -I https://api.promptvalar.com/health


------------------------------------------------------------------------
故障排查
------------------------------------------------------------------------

# 查看后端日志
pm2 logs promptvalar-backend --lines 50

# 查看 Nginx 错误日志
sudo tail -f /var/log/nginx/error.log

# 重启服务
pm2 restart promptvalar-backend
sudo systemctl restart nginx


========================================================================
