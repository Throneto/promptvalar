
> promptvalar-backend@1.0.0 dev
> tsx watch src/index.ts

üöÄ Server running on http://localhost:5000
üìù Environment: development
ValidationError: The Express 'trust proxy' setting is true, which allows anyone to trivially bypass IP-based rate limiting. See https://express-rate-limit.github.io/ERR_ERL_PERMISSIVE_TRUST_PROXY/ for more information.
    at Object.trustProxy (file:///root/promptvalar/node_modules/express-rate-limit/dist/index.mjs:139:13)
    at wrappedValidations.<computed> [as trustProxy] (file:///root/promptvalar/node_modules/express-rate-limit/dist/index.mjs:369:22)
    at Object.keyGenerator (file:///root/promptvalar/node_modules/express-rate-limit/dist/index.mjs:629:20)
    at file:///root/promptvalar/node_modules/express-rate-limit/dist/index.mjs:682:32
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async file:///root/promptvalar/node_modules/express-rate-limit/dist/index.mjs:663:5 {
  code: 'ERR_ERL_PERMISSIVE_TRUST_PROXY',
  help: 'https://express-rate-limit.github.io/ERR_ERL_PERMISSIVE_TRUST_PROXY/'
}
[Êó•Âøó] ËÆ∞ÂΩïÁîüÊàê: be349d73-5ea5-4aee-8b9c-8163440da7cd
[Êó•Âøó] ËÆ∞ÂΩïÁîüÊàê: f8cd39db-6e27-4577-b232-7eff95e4bfa8
10:16:30 PM [tsx] change in ./src/db/index.ts Restarting...
cüöÄ Server running on http://localhost:5000
üìù Environment: development
10:17:36 PM [tsx] change in ./src/index.ts Restarting...
cüöÄ Server running on http://localhost:5000
üìù Environment: development
Error: AppError: Invalid input data
    at generatePrompt (/root/promptvalar/backend/src/controllers/ai.controller.ts:49:9)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at file:///root/promptvalar/node_modules/express-rate-limit/dist/index.mjs:779:7
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async file:///root/promptvalar/node_modules/express-rate-limit/dist/index.mjs:663:5 {
  statusCode: 400,
  code: 'VALIDATION_ERROR',
  details: { errors: [ [Object] ] }
}
[Êó•Âøó] ËÆ∞ÂΩïÁîüÊàê: 46a63678-4671-4c7d-a4f2-64b982e06eab
[Êó•Âøó] ËÆ∞ÂΩïÁîüÊàê: 60c255cd-2833-43d0-8944-76f80dd4694c
[Êó•Âøó] ËÆ∞ÂΩïÁîüÊàê: 3b11b5fd-51a7-4050-aba0-c3624cee5875
[Êó•Âøó] ËÆ∞ÂΩïÁîüÊàê: ad8bc3a0-0ff3-46fa-838f-51fbdd8830fb
[Êó•Âøó] ËÆ∞ÂΩïÁîüÊàê: 0386fb9a-59c8-4372-b996-477568ae0287
Create checkout error: Error: Stripe is not initialized
    at Module.createCheckoutSession (/root/promptvalar/backend/src/services/subscription.service.ts:74:11)
    at createCheckout (/root/promptvalar/backend/src/controllers/subscription.controller.ts:71:47)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:47:5)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
Create checkout error: Error: Stripe is not initialized
    at Module.createCheckoutSession (/root/promptvalar/backend/src/services/subscription.service.ts:74:11)
    at createCheckout (/root/promptvalar/backend/src/controllers/subscription.controller.ts:71:47)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:47:5)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
Error: AppError: Invalid authentication token
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:50:12)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
    at Function.process_params (/root/promptvalar/node_modules/express/lib/router/index.js:346:12)
    at next (/root/promptvalar/node_modules/express/lib/router/index.js:280:10)
    at Function.handle (/root/promptvalar/node_modules/express/lib/router/index.js:175:3)
    at router (/root/promptvalar/node_modules/express/lib/router/index.js:47:12) {
  statusCode: 401,
  code: 'INVALID_TOKEN',
  details: undefined
}
Error: AppError: Invalid input data
    at register (/root/promptvalar/backend/src/controllers/auth.controller.ts:30:9)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
    at Function.process_params (/root/promptvalar/node_modules/express/lib/router/index.js:346:12)
    at next (/root/promptvalar/node_modules/express/lib/router/index.js:280:10)
    at Function.handle (/root/promptvalar/node_modules/express/lib/router/index.js:175:3)
    at router (/root/promptvalar/node_modules/express/lib/router/index.js:47:12) {
  statusCode: 400,
  code: 'VALIDATION_ERROR',
  details: { errors: [ [Object] ] }
}
Create checkout error: Error: Stripe is not initialized
    at Module.createCheckoutSession (/root/promptvalar/backend/src/services/subscription.service.ts:74:11)
    at createCheckout (/root/promptvalar/backend/src/controllers/subscription.controller.ts:71:47)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:47:5)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
Create checkout error: Error: Stripe is not initialized
    at Module.createCheckoutSession (/root/promptvalar/backend/src/services/subscription.service.ts:74:11)
    at createCheckout (/root/promptvalar/backend/src/controllers/subscription.controller.ts:71:47)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:47:5)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
Create checkout error: Error: Stripe is not initialized
    at Module.createCheckoutSession (/root/promptvalar/backend/src/services/subscription.service.ts:74:11)
    at createCheckout (/root/promptvalar/backend/src/controllers/subscription.controller.ts:71:47)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:47:5)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
Create checkout error: Error: Stripe is not initialized
    at Module.createCheckoutSession (/root/promptvalar/backend/src/services/subscription.service.ts:74:11)
    at createCheckout (/root/promptvalar/backend/src/controllers/subscription.controller.ts:71:47)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:47:5)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
Create checkout error: Error: Stripe is not initialized
    at Module.createCheckoutSession (/root/promptvalar/backend/src/services/subscription.service.ts:74:11)
    at createCheckout (/root/promptvalar/backend/src/controllers/subscription.controller.ts:71:47)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:47:5)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
Create checkout error: Error: Stripe is not initialized
    at Module.createCheckoutSession (/root/promptvalar/backend/src/services/subscription.service.ts:74:11)
    at createCheckout (/root/promptvalar/backend/src/controllers/subscription.controller.ts:71:47)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:47:5)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
Create checkout error: Error: Stripe is not initialized
    at Module.createCheckoutSession (/root/promptvalar/backend/src/services/subscription.service.ts:74:11)
    at createCheckout (/root/promptvalar/backend/src/controllers/subscription.controller.ts:71:47)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:47:5)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
Create checkout error: Error: Stripe is not initialized
    at Module.createCheckoutSession (/root/promptvalar/backend/src/services/subscription.service.ts:74:11)
    at createCheckout (/root/promptvalar/backend/src/controllers/subscription.controller.ts:71:47)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:47:5)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
Create checkout error: Error: Stripe is not initialized
    at Module.createCheckoutSession (/root/promptvalar/backend/src/services/subscription.service.ts:74:11)
    at createCheckout (/root/promptvalar/backend/src/controllers/subscription.controller.ts:71:47)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:47:5)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
Create checkout error: Error: Stripe is not initialized
    at Module.createCheckoutSession (/root/promptvalar/backend/src/services/subscription.service.ts:74:11)
    at createCheckout (/root/promptvalar/backend/src/controllers/subscription.controller.ts:71:47)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:47:5)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
Create checkout error: Error: Stripe is not initialized
    at Module.createCheckoutSession (/root/promptvalar/backend/src/services/subscription.service.ts:74:11)
    at createCheckout (/root/promptvalar/backend/src/controllers/subscription.controller.ts:71:47)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:47:5)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
Create checkout error: Error: Stripe is not initialized
    at Module.createCheckoutSession (/root/promptvalar/backend/src/services/subscription.service.ts:74:11)
    at createCheckout (/root/promptvalar/backend/src/controllers/subscription.controller.ts:71:47)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at authenticate (/root/promptvalar/backend/src/middleware/auth.middleware.ts:47:5)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/promptvalar/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/root/promptvalar/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/root/promptvalar/node_modules/express/lib/router/layer.js:95:5)
    at /root/promptvalar/node_modules/express/lib/router/index.js:284:15
